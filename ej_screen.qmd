---
title: "Homework 1: Map making practice"
author: "Jaslyn Miura"
format: html
---


```{r}
library(tidyverse)
library(sf)
library(here)
library(tmap)

# read in geodatabase of EJScreen data at the Census Block Group level
ejscreen <- sf::st_read(here::here("data", "ejscreen","EJSCREEN_2023_BG_StatePct_with_AS_CNMI_GU_VI.gdb")) 

# filter to a state you are interested in
washington <- ejscreen %>%
  dplyr::filter(ST_ABBREV == "WA") 

# filter to a county you are interested in
seattle <- washington %>%
  dplyr::filter(CNTY_NAME %in% c("King County"))

# find the average values for all variables within counties
wa_counties <- aggregate(washington, by = list(washington$CNTY_NAME), FUN = mean)

seattle_counties <- aggregate(seattle, by = list(seattle$CNTY_NAME), FUN = mean)

```


```{r}

# creating map 1

tm_shape(wa_counties, bbox = c(-126, 45.5, -117, 49)) +
  tm_polygons(
    fill = "LOWINCPCT",
    fill.scale = tm_scale(values = "YlGn"),
    fill.legend = tm_legend(title = "Low Income\nProportions")) +
  tm_title(text = "Washington State Low Income Proportions, by County",
           fontface = "bold") +
  tm_compass(position = c("left", "bottom"),
             type = "8star",
             size = 3) +
  tm_scale_bar(position = c("left", "bottom")) +
  tm_components(c("tm_compass", "tm_scalebar"),
                position = c("left", "bottom"))
  
```

The above map displays the average proportion of low income of each county. TALK ABOUT HOW THE LOW INCOME WAS CALCULATED ACCORDING TO THE READ ME. ALSO NOTE THE PROPORTIONS AND HOW THEY MAKE SENSE LIKE AN ENTIRE COUNTY WILL NOT = 1.

```{r}

# creating map 2

tm_shape(wa_counties, bbox = c(-126, 45.5, -117, 49)) +
  tm_polygons(
    fill = "D2_UST",
    fill.scale = tm_scale(values = "YlGn"),
    fill.legend = tm_legend(title = "Average Number\nof LUSTs")) +
  tm_title(text = "Average number of leaking, underground storage tanks (LUSTs)",
           fontface = "bold") +
  tm_compass(type = "8star", 
             size = 3) +
  tm_scale_bar() +
  tm_components(c("tm_compass", "tm_scalebar"),
                position = c("left", "bottom"))

```

Why this makes sense
- it is common for low income/minority communities to experience enviromental injustices i.e. more average number of LUSTs
- why might we have missing data - the grey area is where washington's population is concentrated, this is where the city is 
  - along the coast is where the Olympic National Park is, a protected area, where we would not expect there to be LUSTs.

```{r}
## testing other variables
tm_shape(wa_counties) +
  tm_polygons(
    fill = "PWDIS",
    fill.scale = tm_scale(values = "YlGn"),
    fill.legend = tm_legend(title = "Particulate Matter")) +
  tm_title(text = "Pm 2.5")

```

```{r}
tm_shape(seattle) + 
  tm_polygons()
```

